
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The open source engine for fine-tuning large language models.">
      
      
      
      
        <link rel="prev" href="../completions/">
      
      
        <link rel="next" href="../rate_limits/">
      
      
      <link rel="icon" href="https://raw.githubusercontent.com/scaleapi/llm-engine/main/docs/_static/favicon-32x32.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Fine-tuning - LLM Engine</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/index.css">
    
      <link rel="stylesheet" href="../../assets/css/extra.css">
    
      <link rel="stylesheet" href="../../assets/css/neoteroi.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-N54ZLW5PGC"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-N54ZLW5PGC",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-N54ZLW5PGC",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fine-tuning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="LLM Engine" class="md-header__button md-logo" aria-label="LLM Engine" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/scaleapi/llm-engine/main/docs/_static/favicon-32x32.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LLM Engine
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fine-tuning
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/scaleapi/llm-engine" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    llm-engine
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LLM Engine" class="md-nav__button md-logo" aria-label="LLM Engine" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/scaleapi/llm-engine/main/docs/_static/favicon-32x32.png" alt="logo">

    </a>
    LLM Engine
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/scaleapi/llm-engine" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    llm-engine
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model_zoo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model Zoo
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../completions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Completions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Fine-tuning
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Fine-tuning
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-high-quality-data-for-fine-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      Producing high quality data for fine-tuning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-data" class="md-nav__link">
    <span class="md-ellipsis">
      Preparing data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-your-data-accessible-to-llm-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Making your data accessible to LLM Engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#launching-the-fine-tune" class="md-nav__link">
    <span class="md-ellipsis">
      Launching the fine-tune
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-the-fine-tune" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring the fine-tune
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-inference-calls-to-your-fine-tune" class="md-nav__link">
    <span class="md-ellipsis">
      Making inference calls to your fine-tune
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rate_limits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rate limits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../self_hosting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Self Hosting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/python_client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/data_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Type Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/error_handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Error handling
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integrations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pricing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pricing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-high-quality-data-for-fine-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      Producing high quality data for fine-tuning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparing-data" class="md-nav__link">
    <span class="md-ellipsis">
      Preparing data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-your-data-accessible-to-llm-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Making your data accessible to LLM Engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#launching-the-fine-tune" class="md-nav__link">
    <span class="md-ellipsis">
      Launching the fine-tune
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-the-fine-tune" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring the fine-tune
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-inference-calls-to-your-fine-tune" class="md-nav__link">
    <span class="md-ellipsis">
      Making inference calls to your fine-tune
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="fine-tuning">Fine-tuning<a class="headerlink" href="#fine-tuning" title="Permanent link">&para;</a></h1>
<p>Learn how to customize your models on your data with fine-tuning. Or get started right away with our <a href="https://github.com/scaleapi/llm-engine/blob/main/docs/examples/finetuning.ipynb">fine-tuning cookbook</a>.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Fine-tuning helps improve model performance by training on specific examples of prompts and desired responses. LLMs are initially trained on data collected from the entire internet. With fine-tuning, LLMs can be optimized to perform better in a specific domain by learning from examples for that domain. Smaller LLMs that have been fine-tuned on a specific use case <a href="https://arxiv.org/abs/2305.15334">often outperform</a> larger ones that were trained more generally.</p>
<p>Fine-tuning allows for:</p>
<ol>
<li>Higher quality results than prompt engineering alone</li>
<li>Cost savings through shorter prompts</li>
<li>The ability to reach equivalent accuracy with a smaller model</li>
<li>Lower latency at inference time</li>
<li>The chance to show an LLM more examples than can fit in a single context window</li>
</ol>
<p>LLM Engine's fine-tuning API lets you fine-tune various open source LLMs on your own data and then make inference calls to the resulting LLM. For more specific details, see the <a href="../../api/python_client/#llmengine.FineTune">fine-tuning API reference</a>.</p>
<h2 id="producing-high-quality-data-for-fine-tuning">Producing high quality data for fine-tuning<a class="headerlink" href="#producing-high-quality-data-for-fine-tuning" title="Permanent link">&para;</a></h2>
<p>The training data for fine-tuning should consist of prompt and response pairs.</p>
<p>As a rule of thumb, you should expect to see linear improvements in your fine-tuned model's quality with each doubling of the dataset size. Having high-quality data is also essential to improving performance. For every linear increase in the error rate in your training data, you may encounter a roughly quadratic increase in your fine-tuned model's error rate.</p>
<p>High quality data is critical to achieve improved model performance, and in several cases will require <em>experts</em> to
generate and prepare data - the breadth and diversity of the data is highly critical. Scale's Data Engine can help
prepare such high quality, diverse data sets - more information <a href="https://scale.com/rlhf">here</a>.</p>
<h2 id="preparing-data">Preparing data<a class="headerlink" href="#preparing-data" title="Permanent link">&para;</a></h2>
<p>Your data must be formatted as a CSV file that includes two columns: <code>prompt</code> and <code>response</code>. A maximum of 100,000 rows of data is currently supported. At least 200 rows of data is recommended to start to see benefits from fine-tuning. LLM Engine supports fine-tuning with a training and validation dataset. If only a training dataset is provided, 10% of the data is randomly split to be used as validation.</p>
<p>Here is an example script to create a 50-row CSV of properly formatted data for fine-tuning an airline question answering bot</p>
<details>
<summary>Creating a sample dataset</summary>

<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span style="color: #008000; font-weight: bold">import</span><span style="color: #BBB"> </span><span style="color: #00F; font-weight: bold">csv</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span style="color: #3D7B7B; font-style: italic"># Define data</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>data <span style="color: #666">=</span> [
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    (<span style="color: #BA2121">&quot;What is your policy on carry-on luggage?&quot;</span>, <span style="color: #BA2121">&quot;Our policy allows each passenger to bring one piece of carry-on luggage and one personal item such as a purse or briefcase. The maximum size for carry-on luggage is 22 x 14 x 9 inches.&quot;</span>),
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    (<span style="color: #BA2121">&quot;How can I change my flight?&quot;</span>, <span style="color: #BA2121">&quot;You can change your flight through our website or mobile app. Go to &#39;Manage my booking&#39; section, enter your booking reference and last name, then follow the prompts to change your flight.&quot;</span>),
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    (<span style="color: #BA2121">&quot;What meals are available on my flight?&quot;</span>, <span style="color: #BA2121">&quot;We offer a variety of meals depending on the flight&#39;s duration and route. These can range from snacks and light refreshments to full-course meals on long-haul flights. Specific meal options can be viewed during the booking process.&quot;</span>),
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    (<span style="color: #BA2121">&quot;How early should I arrive at the airport before my flight?&quot;</span>, <span style="color: #BA2121">&quot;We recommend arriving at least two hours before domestic flights and three hours before international flights.&quot;</span>),
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    (<span style="color: #BA2121">&quot;Can I select my seat in advance?&quot;</span>, <span style="color: #BA2121">&quot;Yes, you can select your seat during the booking process or afterwards via the &#39;Manage my booking&#39; section on our website or mobile app.&quot;</span>),
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    (<span style="color: #BA2121">&quot;What should I do if my luggage is lost?&quot;</span>, <span style="color: #BA2121">&quot;If your luggage is lost, please report this immediately at our &#39;Lost and Found&#39; counter at the airport. We will assist you in tracking your luggage.&quot;</span>),
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    (<span style="color: #BA2121">&quot;Do you offer special assistance for passengers with disabilities?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we offer special assistance for passengers with disabilities. Please notify us of your needs at least 48 hours prior to your flight.&quot;</span>),
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    (<span style="color: #BA2121">&quot;Can I bring my pet on the flight?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we allow small pets in the cabin, and larger pets in the cargo hold. Please check our pet policy for more details.&quot;</span>),
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    (<span style="color: #BA2121">&quot;What is your policy on flight cancellations?&quot;</span>, <span style="color: #BA2121">&quot;In case of flight cancellations, we aim to notify passengers as early as possible and offer either a refund or a rebooking on the next available flight.&quot;</span>),
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    (<span style="color: #BA2121">&quot;Can I get a refund if I cancel my flight?&quot;</span>, <span style="color: #BA2121">&quot;Refunds depend on the type of ticket purchased. Please check our cancellation policy for details. Non-refundable tickets, however, are typically not eligible for refunds unless due to extraordinary circumstances.&quot;</span>),
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    (<span style="color: #BA2121">&quot;How can I check-in for my flight?&quot;</span>, <span style="color: #BA2121">&quot;You can check-in for your flight either online, through our mobile app, or at the airport. Online and mobile app check-in opens 24 hours before departure and closes 90 minutes before.&quot;</span>),
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    (<span style="color: #BA2121">&quot;Do you offer free meals on your flights?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we serve free meals on all long-haul flights. For short-haul flights, we offer a complimentary drink and snack. Special meal requests should be made at least 48 hours before departure.&quot;</span>),
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    (<span style="color: #BA2121">&quot;Can I use my electronic devices during the flight?&quot;</span>, <span style="color: #BA2121">&quot;Small electronic devices can be used throughout the flight in flight mode. Larger devices like laptops may be used above 10,000 feet.&quot;</span>),
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    (<span style="color: #BA2121">&quot;How much baggage can I check-in?&quot;</span>, <span style="color: #BA2121">&quot;The checked baggage allowance depends on the class of travel and route. The details would be mentioned on your ticket, or you can check on our website.&quot;</span>),
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    (<span style="color: #BA2121">&quot;How can I request for a wheelchair?&quot;</span>, <span style="color: #BA2121">&quot;To request a wheelchair or any other special assistance, please call our customer service at least 48 hours before your flight.&quot;</span>),
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    (<span style="color: #BA2121">&quot;Do I get a discount for group bookings?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we offer discounts on group bookings of 10 or more passengers. Please contact our group bookings team for more information.&quot;</span>),
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    (<span style="color: #BA2121">&quot;Do you offer Wi-fi on your flights?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we offer complimentary Wi-fi on select flights. You can check the availability during the booking process.&quot;</span>),
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    (<span style="color: #BA2121">&quot;What is the minimum connecting time between flights?&quot;</span>, <span style="color: #BA2121">&quot;The minimum connecting time varies depending on the airport and whether your flight is international or domestic. Generally, it&#39;s recommended to allow at least 45-60 minutes for domestic connections and 60-120 minutes for international.&quot;</span>),
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    (<span style="color: #BA2121">&quot;Do you offer duty-free shopping on international flights?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we have a selection of duty-free items that you can pre-order on our website or purchase onboard on international flights.&quot;</span>),
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    (<span style="color: #BA2121">&quot;Can I upgrade my ticket to business class?&quot;</span>, <span style="color: #BA2121">&quot;Yes, you can upgrade your ticket through the &#39;Manage my booking&#39; section on our website or by contacting our customer service. The availability and costs depend on the specific flight.&quot;</span>),
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    (<span style="color: #BA2121">&quot;Can unaccompanied minors travel on your flights?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we do accommodate unaccompanied minors on our flights, with special services to ensure their safety and comfort. Please contact our customer service for more details.&quot;</span>),
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    (<span style="color: #BA2121">&quot;What amenities do you provide in business class?&quot;</span>, <span style="color: #BA2121">&quot;In business class, you will enjoy additional legroom, reclining seats, premium meals, priority boarding and disembarkation, access to our business lounge, extra baggage allowance, and personalized service.&quot;</span>),
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    (<span style="color: #BA2121">&quot;How much does extra baggage cost?&quot;</span>, <span style="color: #BA2121">&quot;Extra baggage costs vary based on flight route and the weight of the baggage. Please refer to our &#39;Extra Baggage&#39; section on the website for specific rates.&quot;</span>),
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    (<span style="color: #BA2121">&quot;Are there any specific rules for carrying liquids in carry-on?&quot;</span>, <span style="color: #BA2121">&quot;Yes, liquids carried in your hand luggage must be in containers of 100 ml or less and they should all fit into a single, transparent, resealable plastic bag of 20 cm x 20 cm.&quot;</span>),
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    (<span style="color: #BA2121">&quot;What if I have a medical condition that requires special assistance during the flight?&quot;</span>, <span style="color: #BA2121">&quot;We aim to make the flight comfortable for all passengers. If you have a medical condition that may require special assistance, please contact our ‘special services’ team 48 hours before your flight.&quot;</span>),
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    (<span style="color: #BA2121">&quot;What in-flight entertainment options are available?&quot;</span>, <span style="color: #BA2121">&quot;We offer a range of in-flight entertainment options including a selection of movies, TV shows, music, and games, available on your personal seat-back screen.&quot;</span>),
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    (<span style="color: #BA2121">&quot;What types of payment methods do you accept?&quot;</span>, <span style="color: #BA2121">&quot;We accept credit/debit cards, PayPal, bank transfers, and various other forms of payment. The available options may vary depending on the country of departure.&quot;</span>),
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    (<span style="color: #BA2121">&quot;How can I earn and redeem frequent flyer miles?&quot;</span>, <span style="color: #BA2121">&quot;You can earn miles for every journey you take with us or our partner airlines. These miles can be redeemed for flight tickets, upgrades, or various other benefits. To earn and redeem miles, you need to join our frequent flyer program.&quot;</span>),
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    (<span style="color: #BA2121">&quot;Can I bring a stroller for my baby?&quot;</span>, <span style="color: #BA2121">&quot;Yes, you can bring a stroller for your baby. It can be checked in for free and will normally be given back to you at the aircraft door upon arrival.&quot;</span>),
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    (<span style="color: #BA2121">&quot;What age does my child have to be to qualify as an unaccompanied minor?&quot;</span>, <span style="color: #BA2121">&quot;Children aged between 5 and 12 years who are traveling alone are considered unaccompanied minors. Our team provides special care for these children from departure to arrival.&quot;</span>),
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>    (<span style="color: #BA2121">&quot;What documents do I need to travel internationally?&quot;</span>, <span style="color: #BA2121">&quot;For international travel, you need a valid passport and may also require visas, depending on your destination and your country of residence. It&#39;s important to check the specific requirements before you travel.&quot;</span>),
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>    (<span style="color: #BA2121">&quot;What happens if I miss my flight?&quot;</span>, <span style="color: #BA2121">&quot;If you miss your flight, please contact our customer service immediately. Depending on the circumstances, you may be able to rebook on a later flight, but additional fees may apply.&quot;</span>),
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    (<span style="color: #BA2121">&quot;Can I travel with my musical instrument?&quot;</span>, <span style="color: #BA2121">&quot;Yes, small musical instruments can be brought on board as your one carry-on item. Larger instruments must be transported in the cargo, or if small enough, a seat may be purchased for them.&quot;</span>),
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>    (<span style="color: #BA2121">&quot;Do you offer discounts for children or infants?&quot;</span>, <span style="color: #BA2121">&quot;Yes, children aged 2-11 traveling with an adult usually receive a discount on the fare. Infants under the age of 2 who do not occupy a seat can travel for a reduced fare or sometimes for free.&quot;</span>),
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    (<span style="color: #BA2121">&quot;Is smoking allowed on your flights?&quot;</span>, <span style="color: #BA2121">&quot;No, all our flights are non-smoking for the comfort and safety of all passengers.&quot;</span>),
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    (<span style="color: #BA2121">&quot;Do you have family seating?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we offer the option to seat families together. You can select seats during booking or afterwards through the &#39;Manage my booking&#39; section on the website.&quot;</span>),
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    (<span style="color: #BA2121">&quot;Is there any discount for senior citizens?&quot;</span>, <span style="color: #BA2121">&quot;Some flights may offer a discount for senior citizens. Please check our website or contact customer service for accurate information.&quot;</span>),
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    (<span style="color: #BA2121">&quot;What items are prohibited on your flights?&quot;</span>, <span style="color: #BA2121">&quot;Prohibited items include, but are not limited to, sharp objects, firearms, explosive materials, and certain chemicals. You can find a comprehensive list on our website under the &#39;Security Regulations&#39; section.&quot;</span>),
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>    (<span style="color: #BA2121">&quot;Can I purchase a ticket for someone else?&quot;</span>, <span style="color: #BA2121">&quot;Yes, you can purchase a ticket for someone else. You&#39;ll need their correct name as it appears on their government-issued ID, and their correct travel dates.&quot;</span>),
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>    (<span style="color: #BA2121">&quot;What is the process for lost and found items on the plane?&quot;</span>, <span style="color: #BA2121">&quot;If you realize you forgot an item on the plane, report it as soon as possible to our lost and found counter. We will make every effort to locate and return your item.&quot;</span>),
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>    (<span style="color: #BA2121">&quot;Can I request a special meal?&quot;</span>, <span style="color: #BA2121">&quot;Yes, we offer a variety of special meals to accommodate dietary restrictions. Please request your preferred meal at least 48 hours prior to your flight.&quot;</span>),
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>    (<span style="color: #BA2121">&quot;Is there a weight limit for checked baggage?&quot;</span>, <span style="color: #BA2121">&quot;Yes, luggage weight limits depend on your ticket class and route. You can find the details on your ticket or by visiting our website.&quot;</span>),
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>    (<span style="color: #BA2121">&quot;Can I bring my sports equipment?&quot;</span>, <span style="color: #BA2121">&quot;Yes, certain types of sports equipment can be carried either as or in addition to your permitted baggage. Some equipment may require additional fees. It&#39;s best to check our policy on our website or contact us directly.&quot;</span>),
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>    (<span style="color: #BA2121">&quot;Do I need a visa to travel to certain countries?&quot;</span>, <span style="color: #BA2121">&quot;Yes, visa requirements depend on the country you are visiting and your nationality. We advise checking with the relevant embassy or consulate prior to travel.&quot;</span>),
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>    (<span style="color: #BA2121">&quot;How can I add extra baggage to my booking?&quot;</span>, <span style="color: #BA2121">&quot;You can add extra baggage to your booking through the &#39;Manage my booking&#39; section on our website or by contacting our customer services.&quot;</span>),
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>    (<span style="color: #BA2121">&quot;Can I check-in at the airport?&quot;</span>, <span style="color: #BA2121">&quot;Yes, you can choose to check-in at the airport. However, we also offer online and mobile check-in, which may save you time.&quot;</span>),
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>    (<span style="color: #BA2121">&quot;How do I know if my flight is delayed or cancelled?&quot;</span>, <span style="color: #BA2121">&quot;In case of any changes to your flight, we will attempt to notify all passengers using the contact information given at the time of booking. You can also check your flight status on our website.&quot;</span>),
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>    (<span style="color: #BA2121">&quot;What is your policy on pregnant passengers?&quot;</span>, <span style="color: #BA2121">&quot;Pregnant passengers can travel up to the end of the 36th week for single pregnancies, and the end of the 32nd week for multiple pregnancies. We recommend consulting your doctor before any air travel.&quot;</span>),
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>    (<span style="color: #BA2121">&quot;Can children travel alone?&quot;</span>, <span style="color: #BA2121">&quot;Yes, children age 5 to 12 can travel alone as unaccompanied minors. We provide special care for these seats. Please contact our customer service for more information.&quot;</span>),
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>    (<span style="color: #BA2121">&quot;How can I pay for my booking?&quot;</span>, <span style="color: #BA2121">&quot;You can pay for your booking using a variety of methods including credit and debit cards, PayPal, or bank transfers. The options may vary depending on the country of departure.&quot;</span>),
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>]
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span style="color: #3D7B7B; font-style: italic"># Write data to a CSV file</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span style="color: #008000; font-weight: bold">with</span> <span style="color: #008000">open</span>(<span style="color: #BA2121">&#39;customer_service_data.csv&#39;</span>, <span style="color: #BA2121">&#39;w&#39;</span>, newline<span style="color: #666">=</span><span style="color: #BA2121">&#39;&#39;</span>) <span style="color: #008000; font-weight: bold">as</span> file:
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>    writer <span style="color: #666">=</span> csv<span style="color: #666">.</span>writer(file)
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>    writer<span style="color: #666">.</span>writerow([<span style="color: #BA2121">&quot;prompt&quot;</span>, <span style="color: #BA2121">&quot;response&quot;</span>])
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>    writer<span style="color: #666">.</span>writerows(data)
</code></pre></div>

</details>

<h2 id="making-your-data-accessible-to-llm-engine">Making your data accessible to LLM Engine<a class="headerlink" href="#making-your-data-accessible-to-llm-engine" title="Permanent link">&para;</a></h2>
<p>Currently, data needs to be uploaded to either a publicly accessible web URL or to LLM Engine's private file server so that it can be read for fine-tuning. Publicly accessible HTTP and HTTPS URLs are currently supported.</p>
<p>To privately share data with the LLM Engine API, use LLM Engine's <a href="../../api/python_client/#llmengine.File.upload">File.upload</a> API. You can upload data in local file to LLM Engine's private file server and then use the returned file ID to reference your data in the FineTune API. The file ID is generally in the form of <code>file-&lt;random_string&gt;</code>, e.g. "file-7DLVeLdN2Ty4M2m".</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Upload to LLM Engine's private file server</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span style="color: #008000; font-weight: bold">from</span><span style="color: #BBB"> </span><span style="color: #00F; font-weight: bold">llmengine</span><span style="color: #BBB"> </span><span style="color: #008000; font-weight: bold">import</span> File
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>response <span style="color: #666">=</span> File<span style="color: #666">.</span>upload(<span style="color: #008000">open</span>(<span style="color: #BA2121">&quot;customer_service_data.csv&quot;</span>, <span style="color: #BA2121">&quot;r&quot;</span>))
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span style="color: #008000">print</span>(response<span style="color: #666">.</span>json())
</code></pre></div>
<h2 id="launching-the-fine-tune">Launching the fine-tune<a class="headerlink" href="#launching-the-fine-tune" title="Permanent link">&para;</a></h2>
<p>Once you have uploaded your data, you can use the LLM Engine's <a href="../../api/python_client/#llmengine.fine_tuning.FineTune.create">FineTune.Create</a> API to launch a fine-tune. You will need to specify which base model to fine-tune, the locations of the training file and optional validation data file, an optional set of hyperparameters to customize the fine-tuning behavior, and an optional suffix to append to the name of the fine-tune. For sequences longer than the native
<code>max_seq_length</code> of the model, the sequences will be truncated.</p>
<p>If you specify a suffix, the fine-tune will be named <code>model.suffix.&lt;timestamp&gt;</code>. If you do not,
the fine-tune will be named <code>model.&lt;timestamp&gt;</code>. The timestamp will be the time the fine-tune was
launched. Note: the suffix must only contain alphanumeric characters and hyphens, and be at most 28 characters long.</p>
<details>
<summary>Hyper-parameters for fine-tune</summary>

- `lr`: Peak learning rate used during fine-tuning. It decays with a cosine schedule afterward. (Default: 2e-3)
- `warmup_ratio`: Ratio of training steps used for learning rate warmup. (Default: 0.03)
- `epochs`: Number of fine-tuning epochs. This should be less than 20. (Default: 5)
- `weight_decay`: Regularization penalty applied to learned weights. (Default: 0.001)
</details>

<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Create a fine-tune in python</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span style="color: #008000; font-weight: bold">from</span><span style="color: #BBB"> </span><span style="color: #00F; font-weight: bold">llmengine</span><span style="color: #BBB"> </span><span style="color: #008000; font-weight: bold">import</span> FineTune
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>response <span style="color: #666">=</span> FineTune<span style="color: #666">.</span>create(
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    model<span style="color: #666">=</span><span style="color: #BA2121">&quot;llama-2-7b&quot;</span>,
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    training_file<span style="color: #666">=</span><span style="color: #BA2121">&quot;file-AbCDeLdN2Ty4M2m&quot;</span>,
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    validation_file<span style="color: #666">=</span><span style="color: #BA2121">&quot;file-ezSRpgtKQyItI26&quot;</span>,
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>)
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span style="color: #008000">print</span>(response<span style="color: #666">.</span>json())
</code></pre></div>
<p>See the <a href="../../model_zoo">Model Zoo</a> to see which models have fine-tuning support.</p>
<p>See <a href="../../integrations/">Integrations</a> to see how to track fine-tuning metrics.</p>
<h2 id="monitoring-the-fine-tune">Monitoring the fine-tune<a class="headerlink" href="#monitoring-the-fine-tune" title="Permanent link">&para;</a></h2>
<p>Once the fine-tune is launched, you can also <a href="../../api/python_client/#llmengine.fine_tuning.FineTune.get">get the status of your fine-tune</a>. 
You can also <a href="../../api/python_client/#llmengine.fine_tuning.FineTune.get_events">list events that your fine-tune produces</a>.
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span style="color: #008000; font-weight: bold">from</span><span style="color: #BBB"> </span><span style="color: #00F; font-weight: bold">llmengine</span><span style="color: #BBB"> </span><span style="color: #008000; font-weight: bold">import</span> FineTune
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>fine_tune_id <span style="color: #666">=</span> <span style="color: #BA2121">&quot;ft-cabcdefghi1234567890&quot;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>fine_tune <span style="color: #666">=</span> FineTune<span style="color: #666">.</span>get(fine_tune_id)
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span style="color: #008000">print</span>(fine_tune<span style="color: #666">.</span>status)  <span style="color: #3D7B7B; font-style: italic"># BatchJobStatus.RUNNING</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span style="color: #008000">print</span>(fine_tune<span style="color: #666">.</span>fine_tuned_model)  <span style="color: #3D7B7B; font-style: italic"># &quot;llama-2-7b.700101-000000</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>fine_tune_events <span style="color: #666">=</span> FineTune<span style="color: #666">.</span>get_events(fine_tune_id)
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span style="color: #008000; font-weight: bold">for</span> event <span style="color: #A2F; font-weight: bold">in</span> fine_tune_events<span style="color: #666">.</span>events:
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span style="color: #008000">print</span>(event)
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span style="color: #3D7B7B; font-style: italic"># Prints something like:</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span style="color: #3D7B7B; font-style: italic"># timestamp=1697590000.0 message=&quot;{&#39;loss&#39;: 12.345, &#39;learning_rate&#39;: 0.0, &#39;epoch&#39;: 0.97}&quot; level=&#39;info&#39;</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span style="color: #3D7B7B; font-style: italic"># timestamp=1697590000.0 message=&quot;{&#39;eval_loss&#39;: 23.456, &#39;eval_runtime&#39;: 19.876, &#39;eval_samples_per_second&#39;: 4.9, &#39;eval_steps_per_second&#39;: 4.9, &#39;epoch&#39;: 0.97}&quot; level=&#39;info&#39;</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span style="color: #3D7B7B; font-style: italic"># timestamp=1697590020.0 message=&quot;{&#39;train_runtime&#39;: 421.234, &#39;train_samples_per_second&#39;: 2.042, &#39;train_steps_per_second&#39;: 0.042, &#39;total_flos&#39;: 123.45, &#39;train_loss&#39;: 34.567, &#39;epoch&#39;: 0.97}&quot; level=&#39;info&#39;</span>
</code></pre></div></p>
<p>The status of your fine-tune will give a high-level overview of the fine-tune's progress.
The events of your fine-tune will give more detail, such as the training loss and validation loss at each epoch, 
as well as any errors that may have occurred. If you encounter any errors with your fine-tune, 
the events are a good place to start debugging. For example, if you see <code>Unable to read training or validation dataset</code>,
you may need to make your files accessible to LLM Engine. If you see <code>Invalid value received for lora parameter 'lora_alpha'!</code>,
you should <a href="../../api/python_client/#llmengine.fine_tuning.FineTune.create">check that your hyperparameters are valid</a>.</p>
<h2 id="making-inference-calls-to-your-fine-tune">Making inference calls to your fine-tune<a class="headerlink" href="#making-inference-calls-to-your-fine-tune" title="Permanent link">&para;</a></h2>
<p>Once your fine-tune is finished, you will be able to start making inference requests to the
model. You can use the <code>fine_tuned_model</code> returned from your
<a href="../../api/python_client/#llmengine.fine_tuning.FineTune.get">FineTune.get</a>
API call to reference your fine-tuned model in the Completions API. Alternatively, you can list
available LLMs with <code>Model.list</code> in order to find the name of your fine-tuned model. See the
<a href="../../api/python_client/#llmengine.Completion">Completion API</a> for more details. You can then
use that name to direct your completion requests. You must wait until your fine-tune is complete
before you can plug it into the Completions API. You can check the status of your fine-tune with
<a href="../../api/python_client/#llmengine.fine_tuning.FineTune.get">FineTune.get</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Inference with a fine-tuned model in python</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span style="color: #008000; font-weight: bold">from</span><span style="color: #BBB"> </span><span style="color: #00F; font-weight: bold">llmengine</span><span style="color: #BBB"> </span><span style="color: #008000; font-weight: bold">import</span> Completion
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>response <span style="color: #666">=</span> Completion<span style="color: #666">.</span>create(
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    model<span style="color: #666">=</span><span style="color: #BA2121">&quot;llama-2-7b.airlines.2023-07-17-08-30-45&quot;</span>,
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    prompt<span style="color: #666">=</span><span style="color: #BA2121">&quot;Do you offer in-flight Wi-fi?&quot;</span>,
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    max_new_tokens<span style="color: #666">=100</span>,
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    temperature<span style="color: #666">=0.2</span>,
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>)
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span style="color: #008000">print</span>(response<span style="color: #666">.</span>json())
</code></pre></div>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="..." target="_blank" rel="noopener">feedback form</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link", "content.code.annotate", "navigation.expand", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>